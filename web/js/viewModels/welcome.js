define(["ojs/ojcore","knockout","jquery","appController","config/appconfig","ojs/ojdialog","ojs/ojformlayout","ojs/ojinputtext"],function(e,o,n,t,a){return new function(){var s=this,l=e.Router.rootInstance,i=a.get("baseURL"),r=a.get("loginEndpoint"),u=a.get("loginEnabled"),c=a.get("rewardsEnabled");u||t.userid(a.get("defaultUser")),s.username=new o.observable("user@email.com"),s.password=new o.observable(""),s.signUpMe=function(){window.location="http://127.0.0.1:9001/index.php",console.log("sign up")},s.signInMe=function(){document.querySelector("#loginDialog").open()},s.login=function(){u?""==s.password()||null==s.password()?alert("Password cannot be empty. Please try again."):n.post(i+r,{username:s.username,password:s.password},function(e,o){"success"==o&&"success"==e.result?(t.userid(e.memberno),console.log("get userid from backend api: "+t.userid()),t.logg(!0),console.log("after setup logged in: "+t.logg()),s.loginComplete()):(console.log("status: "+o+" result: "+e.result),alert("Incorrect username/password. Please try again."))}):s.loginComplete()},s.loginComplete=function(){document.querySelector("#loginDialog").close(),c?(t.navDataSource.change([{name:"Rewards",id:"reward",disabled:!1},{name:"Logout",id:"logout",disabled:!1}]),l.go("reward")):l.go("unavailable")},s.startAnimationListener=function(o){var t=o.detail;n(o.target).is(".oj-dialog")&&("open"===t.action?(o.preventDefault(),e.AnimationUtils.zoomIn(t.element,{duration:"400ms"}).then(t.endCallback)):"close"===t.action&&(o.preventDefault(),t.endCallback()))},s.connected=function(){},s.disconnected=function(){},s.transitionCompleted=function(){}}});